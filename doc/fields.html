<h1 id="fields">Fields</h1>
<p>Facade for creating and managing form fields.</p>
<ul>
<li><p>Put complexity and ui logic as far away from the HTML/controllers as<br />possible (hierarchy of directives).</p></li>
<li><p>Encapsulate implementation and provide common interfaces to different<br />implementations which serve similar purposes.</p></li>
<li><p>Prefer to decorate existing ui controls, rather than creating custom ones.<br />This reduces the risk of accessibility and compatability issues.</p></li>
</ul>
<h2 id="field-directive">Field directive</h2>
<p><code>&lt;field ...&gt;&lt;/field&gt;</code> or <code>&lt;field:auto ...&gt;&lt;/field:auto&gt;</code></p>
<p>A common interface to form fields.</p>
<h3 id="purpose-attribute">Purpose attribute</h3>
<p>Generally, the actual implementation of the field is of little importance so long<br />as the field is user-friendly for its desired purpose. This directive allows<br />fields to be specified by their <em>purpose</em>, and the actual implementation used is<br />chosen dynamically. This is particularly useful when automatically generating<br />forms from database schemas or reflection on DTOs.</p>
<p>You can of course specify an explicit implementation via this directive though if<br />it does not seem to choose a good one automatically.</p>
<p>The hierarchy is as follows:</p>
<ol>
<li><p><code>&lt;field&gt;</code> or <code>&lt;field:auto&gt;</code>, specifying the purpose of the field via the<br /><code>purpose</code> attribute.</p></li>
<li><p>Purpose directives, e.g. <code>&lt;field:choice&gt;</code> for <code>purpose=&quot;choice&quot;</code>. These use<br />some heuristic to determine which implementation to use.</p></li>
<li><p>Implementation directive, e.g. <code>&lt;field:radio-group&gt;</code>. These represent a<br />particular implementation.</p></li>
</ol>
<p>For selecting a country, we would typically want a drop-down list or a list-box<br />as there are many possible choices. The following directive produces a drop-down.</p>
<pre><code>&lt;field title=&quot;Country&quot; purpose=&quot;choice&quot; ng-model=&quot;model.country&quot; choices=&quot;data.countries&quot;&gt;&lt;/field&gt;</code></pre>
<p>For selecting a gender, we would typically want a radio-list, since there are few<br />choices, so a radio-list is more user-friendly than a drop-down.</p>
<pre><code>&lt;field title=&quot;Gender&quot; purpose=&quot;choice&quot; ng-model=&quot;model.gender&quot; choices=&quot;data.genders&quot;&gt;&lt;/field&gt;</code></pre>
<p>Attributes in this example:</p>
<ul>
<li><p><code>title</code> (required): This has no purpose other than to create a visual label<br />on the form, for the user.</p></li>
<li><p><code>ng-model</code> (required): Usual meaning, the view-model field which is<br />data-bound to this ui field.</p></li>
<li><p><code>purpose</code> (required): The purpose of the field. In this case, the purpose is<br />to provide a <em>choice</em> of values.</p></li>
<li><p><code>choices</code> (required for purpose=choice): An array of choices that are<br />presented to the user.</p></li>
</ul>
<p>The <code>field</code> directive proxies to the <code>field:choice</code> directive. This directive<br />applies a heuristic (in this case, it looks at <code>choices.length</code>) to determine<br />which implementation to use. For many choices, it proxies to<br /><code>field:drop-down-list</code> and for few choices, it proxies to <code>field:radio-group</code>.</p>
<p>The heuristic could also include checking browser details such as screen size,<br />is the device touch-screen, which implementations are compatible with the browser,<br />et cetera. Hence the actual forms do not need to care about client-specific<br />details, the forms only specify lists of fields and their purposes. If one day<br />we find that <code>jQueryUI-OMGthisWidgetIsAwesome</code> isn't supported by the browser<br />that ships with the Banana uPhone 9S, or users on non-touch devices find it<br />difficult to use, then we can simply edit the heuristics which may generate it in<br />the relevant purpose directives, rather than having to modify every form<br />individually.</p>
<p>This also allows optional dependencies, e.g. an implementation directive for the<br />jQuery UI autocomplete could check if jQuery UI is loaded, and it is not then the<br />directive could proxy to one which generates a simple text-box instead.</p>
<p>Note that the only practical difference between</p>
<pre><code>&lt;field title=&quot;Country&quot; purpose=&quot;choice&quot; ng-model=&quot;model.country&quot; choices=&quot;data.countries&quot;&gt;&lt;/field&gt;</code></pre>
<p>and</p>
<pre><code>&lt;field:choice title=&quot;Country&quot; ng-model=&quot;model.country&quot; choices=&quot;data.countries&quot;&gt;&lt;/field:choice&gt;</code></pre>
<p>is that the latter does not wrap the field in a <code>&lt;label&gt;</code> element (this is done<br />by the <code>field</code> directive).</p>
<p>You may override parameters of the heuristic by giving <em>hints</em>:</p>
<pre><code>&lt;field:choice title=&quot;Country&quot; ng-model=&quot;model.country&quot; choices=&quot;data.countries&quot; hints=&quot;many&quot;&gt;&lt;/field:choice&gt;</code></pre>
<p>This tells the heuristic that there are <code>many</code> choices, which will cause it to<br />choose an implementation suitable for such a use case (e.g. a drop-down list).</p>
<p>Likewise, we could tell it that there are <code>not many</code> choices:</p>
<pre><code>&lt;field:choice title=&quot;Country&quot; ng-model=&quot;model.country&quot; choices=&quot;data.countries&quot; hints=&quot;not many&quot;&gt;&lt;/field:choice&gt;</code></pre>
<p>This will probably result in a radio-group.</p>
<p>We can give multiple hints:</p>
<pre><code>&lt;field:choice title=&quot;Country&quot; ng-model=&quot;model.country&quot; choices=&quot;data.countries&quot; hints=&quot;many,custom&quot;&gt;&lt;/field:choice&gt;</code></pre>
<p>This specifies to use an implementation which suits <code>many</code> choices and <code>custom</code><br />(i.e. user-provided) choices - such as an autocomplete/typeahead field.</p>
<h2 id="demo-app-a-form">Demo app (a form)</h2>
<p>Dependencies: utils, directive-proxy, fields</p>
<h3 id="app.js">app.js</h3>
<pre><code>angular.module(&#39;demoApp&#39;, [&#39;fields&#39;]);

angular.module(&#39;demoApp&#39;)
    .controller(&#39;demoController&#39;, demoController);

function demoController($scope) {

    $scope.model = {
        gender: &#39;M&#39;,
        country: 44,
        genders: [],
        countries: [372, 358, 380, 354, 370]
    };

    $scope.data = {
        genders: [
            { title: &#39;Male&#39;, value: &#39;M&#39; },
            { title: &#39;Female&#39;, value: &#39;F&#39; }
        ],
        countries: [
            { title: &#39;Estonia&#39;, value: 372 },
            { title: &#39;UK&#39;, value: 44 },
            { title: &#39;USA&#39;, value: 1 },
            { title: &#39;Finland&#39;, value: 358 },
            { title: &#39;Lithuania&#39;, value: 370 },
            { title: &#39;France&#39;, value: 33 },
            { title: &#39;Latvia&#39;, value: 371 },
            { title: &#39;Iceland&#39;, value: 354 },
            { title: &#39;Ukraine&#39;, value: 380 },
            { title: &#39;Belgium&#39;, value: 32 }
        ]
    };

}</code></pre>
<h3 id="index.html">index.html</h3>
<pre><code>&lt;!doctype html&gt;
&lt;html lang=&quot;en&quot; ng-app=&quot;demoApp&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf8&quot;&gt;
    &lt;title&gt;Test&lt;/title&gt;
    &lt;!-- Nice form styles --&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;sanwebe-style.css&quot;&gt;
    &lt;!-- Underscore --&gt;
    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.7.0/underscore-min.js&quot;&gt;&lt;/script&gt;
    &lt;!-- Angular --&gt;
    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.3.0-beta.13/angular.min.js&quot;&gt;&lt;/script&gt;
    &lt;!-- Angular bootstrap --&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css&quot;&gt;
    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/0.11.2/ui-bootstrap-tpls.min.js&quot;&gt;&lt;/script&gt;
    &lt;!-- Module --&gt;
    &lt;script src=&quot;utils/module.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;utils/underscore.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;directive-proxy/module.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;directive-proxy/directive-proxy-service.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;fields/module.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;fields/hint-parse-service.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;fields/field-facade.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;fields/choice-facade.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;fields/multichoice-facade.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;fields/drop-down-list-directive.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;fields/fixed-list-directive.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;fields/radio-group-directive.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;fields/multiselect-fixed-list-directive.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;fields/checkbox-group-directive.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;fields/text-box-directive.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;fields/autocomplete-directive.js&quot;&gt;&lt;/script&gt;
    &lt;!-- Local --&gt;
    &lt;script src=&quot;app.js&quot;&gt;&lt;/script&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;style.css&quot;&gt;
&lt;/head&gt;
&lt;body ng-controller=&quot;demoController&quot;&gt;
    &lt;form class=&quot;smart-green&quot;&gt;
        &lt;h1&gt;Experiment&lt;/h1&gt;
        &lt;fieldset&gt;
            &lt;legend&gt;Field purpose specified only&lt;/legend&gt;
            &lt;div class=&quot;cols&quot;&gt;
                &lt;div&gt;
                    &lt;fieldset&gt;
                        &lt;legend&gt;Choice&lt;/legend&gt;
                            &lt;field:auto title=&quot;Gender&quot; x-purpose=&quot;choice&quot; ng-model=&quot;model.gender&quot; x-choices=&quot;data.genders&quot;&gt;&lt;/field:auto&gt;
                            &lt;field:auto title=&quot;Country&quot; x-purpose=&quot;choice&quot; ng-model=&quot;model.country&quot; x-choices=&quot;data.countries&quot;&gt;&lt;/field:auto&gt;
                    &lt;/fieldset&gt;
                    &lt;fieldset&gt;
                        &lt;legend&gt;Multichoice&lt;/legend&gt;
                        &lt;field:auto title=&quot;Genders&quot; x-purpose=&quot;multichoice&quot; ng-model=&quot;model.genders&quot; x-choices=&quot;data.genders&quot; x-hints=&quot;optional,many&quot; size=&quot;2&quot;&gt;&lt;/field:auto&gt;
                    &lt;/fieldset&gt;
                &lt;/div&gt;
                &lt;fieldset&gt;
                    &lt;legend&gt;Multichoice&lt;/legend&gt;
                    &lt;field:auto title=&quot;Genders&quot; x-purpose=&quot;multichoice&quot; ng-model=&quot;model.genders&quot; x-choices=&quot;data.genders&quot; x-hints=&quot;optional&quot;&gt;&lt;/field:auto&gt;
                    &lt;field:auto title=&quot;Countries&quot; x-purpose=&quot;multichoice&quot; ng-model=&quot;model.countries&quot; x-choices=&quot;data.countries&quot;&gt;&lt;/field:auto&gt;
                &lt;/fieldset&gt;
            &lt;/div&gt;
        &lt;/fieldset&gt;
        &lt;fieldset&gt;
            &lt;legend&gt;Specify field purpose with hints&lt;/legend&gt;
            &lt;field:auto title=&quot;Gender with hint &#39;many&#39;&quot; x-purpose=&quot;choice&quot; x-hints=&quot;many&quot; ng-model=&quot;model.gender&quot; x-choices=&quot;data.genders&quot;&gt;&lt;/field:auto&gt;
            &lt;field:auto title=&quot;Country with hint &#39;not many&#39;&quot; x-purpose=&quot;choice&quot; x-hints=&quot;not many&quot; ng-model=&quot;model.country&quot; x-choices=&quot;data.countries&quot;&gt;&lt;/field:auto&gt;
            &lt;field:auto title=&quot;Country with hint &#39;custom&#39;&quot; x-purpose=&quot;choice&quot; x-hints=&quot;many,custom&quot; ng-model=&quot;model.country&quot; x-choices=&quot;data.countries&quot;&gt;&lt;/field:auto&gt;
        &lt;/fieldset&gt;
        &lt;fieldset&gt;
            &lt;legend&gt;Request specific implementations&lt;/legend&gt;
            &lt;field:auto title=&quot;Gender as &#39;text-box&#39;&quot; x-purpose=&quot;text-box&quot; ng-model=&quot;model.gender&quot; x-choices=&quot;data.genders&quot;&gt;&lt;/field:auto&gt;
            &lt;field:auto title=&quot;Country as &#39;autocomplete&#39;&quot; x-purpose=&quot;autocomplete&quot; ng-model=&quot;model.country&quot; x-choices=&quot;data.countries&quot;&gt;&lt;/field:auto&gt;
        &lt;/fieldset&gt;
        &lt;fieldset&gt;
            &lt;legend&gt;Model&lt;/legend&gt;
            &lt;pre&gt;{{ model | json }}&lt;/pre&gt;
        &lt;/fieldset&gt;
        &lt;fieldset&gt;
            &lt;legend&gt;Data&lt;/legend&gt;
            &lt;pre&gt;{{ data | json }}&lt;/pre&gt;
        &lt;/fieldset&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<h3 id="style.css">style.css</h3>
<pre><code>body {
    padding: 60px;
    background: #333;
}

label {
    padding-top: 10px;
}

pre {
    white-space: pre-wrap;
}

form {
}

legend {
    font-size: inherit;
    position: relative;
    left: -10px;
    padding: 0 2px;
    margin: 0;
    border: 0;
    display: inline-block;
    width: auto;
}

fieldset {
    display: block;
    border: 0;
    border: 1px solid silver;
    border-radius: 12px;
    padding: 0 10px 10px 20px;
}

input,textarea,select {
    box-sizing: border-box;
}

fieldset,
.cols {
    margin-top: 20px;
    margin-bottom: 20px;
}

.cols {
    display: flex;
    flex-flow: row nowrap;
    align-items: stretch;
    justify-content: space-between;
}

/* TODO: Make a proper .rows class, and get rid of these asterisks */
.cols&gt;* {
    margin-top: 0;
    margin-bottom: 0;
    flex-grow: 1;
}
.cols&gt;*+* {
    margin-left: 20px;
}

.cols&gt;*&gt;fieldset:first-child {
    margin-top: 0;
}

.cols&gt;*&gt;fieldset:last-child {
    margin-bottom: 0;
}

.field {
    margin-top: 10px;
}

.field-label {
    text-indent: -8px;
    margin-bottom: 5px;
    font-weight: bold;
    display: block;
    clear: both;
}

.field-choicebox-group {
    display: block;
}

.field-choicebox-group&gt;.choicebox-item {
    min-width: 80px;
    margin-right: 20px;
    display: inline-block;
    white-space: pre;
}

.field-choicebox-group&gt;.choicebox-item&gt;.choicebox-box {
    float: none;
    margin: 0;
    display: inline-block;
    vertical-align: top;
}

.field-choicebox-group&gt;.choicebox-item&gt;.choicebox-label {
    margin: 0 0 0 5px;
    display: inline-block;
    float: none;
    vertical-align: top;
}

.ng-invalid:not(:focus) {
    box-shadow: 0 0 3px 1px red;
}

.field .field-choicebox-group {
    box-shadow: none;
}</code></pre>
<h3 id="sanwebe-style.css">sanwebe-style.css</h3>
<pre><code>/*
 * Taken from http://www.sanwebe.com/2013/10/css-html-form-styles, no license
 * was specified.
 */
html,body{
    margin:0px;
    padding:0px;
}
h3 {
    text-align: center;
    font-family: georgia;
    color: #727272;
    border-bottom: 1px solid #EEE;
    padding: 5px;
    font-size: x-large;
    margin-top: 50px;
}
.smart-green {
    margin-left:auto;
    margin-right:auto;
    max-width: 800px;
    background: #F8F8F8;
    padding: 30px 30px 20px 30px;
    font: 12px Arial, Helvetica, sans-serif;
    color: #666;
    border-radius: 5px;
}
.smart-green h1 {
    font: 24px &quot;Trebuchet MS&quot;, Arial, Helvetica, sans-serif;
    padding: 20px 0px 20px 40px;
    display: block;
    margin: -30px -30px 10px -30px;
    color: #FFF;
    background: #9DC45F;
    text-shadow: 1px 1px 1px #949494;
    border-radius: 5px 5px 0px 0px;
    border-bottom:1px solid #89AF4C;
}
.smart-green h1&gt;span {
    display: block;
    font-size: 11px;
    color: #FFF;
}
.smart-green label {
    display: block;
    margin: 0px 0px 5px;
}
.smart-green label&gt;span {
    float: left;
    margin-top: 10px;
    color: #5E5E5E;
}
.smart-green input[type=&quot;text&quot;], .smart-green input[type=&quot;email&quot;], .smart-green textarea, .smart-green select {
    color: #555;
    height: 30px;
    line-height:15px;
    width: 100%;
    padding: 0px 0px 0px 10px;
    margin-top: 2px;
    border: 1px solid #E5E5E5;
    background: #FBFBFB;
    outline: 0;
    box-shadow: inset 1px 1px 2px rgba(238, 238, 238, 0.2);
    font: normal 14px/14px Arial, Helvetica, sans-serif;
}
.smart-green textarea{
    height:100px;
    padding-top: 10px;
}
.smart-green select {
    text-indent: 0.01px;
    text-overflow: &#39;&#39;;
    width:100%;
    height:30px;
}
.smart-green .button {
    background-color: #9DC45F;
    border-radius: 5px;
    border: none;
    padding: 10px 25px 10px 25px;
    color: #FFF;
    text-shadow: 1px 1px 1px #949494;
}
.smart-green .button:hover {
    background-color:#80A24A;
}</code></pre>
